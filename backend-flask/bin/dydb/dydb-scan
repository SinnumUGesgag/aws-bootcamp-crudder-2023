#! /usr/bin/env python

import boto3
import sys


# Setting Essetinal Attributes for our Client ---------------- >
attributes = {  # point boto3 client at the dynamoDB container we have running locally
    'endpoint_url': 'http://localhost:8000'
}


if len(sys.argv) == 2:          # pull the arguments being pull has a length of 2, meaning 2 arguments
    if "prod" in sys.argv[1]:   # if first argument is prod
        attribute = {}
        print(f"""!!! DO NOT SCAN PRODUCTION DYDB !!!""")
else: 
    # I only want it to be able to scan IF it's NOT the Production DyDb instance & only the local DyDb other it gets expensive quick
    print(f"""!!! SCANNING LOCAL DEV DYDB ONLY !!!""")       
    dynamodbResource = boto3.resource('dynamodb', **attributes)
    table_name = "cruddur_messages"
    table = dynamodbResource.Table(table_name)
    response = table.scan()
    items = response['Items']
    for item in items:
        print(item)






